# 用户故事规格书：英语写作导师

<meta>
  <document-id>english-writing-tutor-userstory-spec</document-id>
  <version>1.0.0</version>
  <project>英语写作导师</project>
  <type>用户故事规格书</type>
  <created>2025-12-07</created>
  <depends>real.md, cog.md</depends>
</meta>

---

## 复杂故事概览

| 复杂故事 | 名称 | 最小故事数 | 优先级 | 故事类型分布 |
|---------|------|-----------|--------|-------------|
| CS-01 | 学生入门 | 4 | P0 | 光明3, 黑暗1 |
| CS-02 | 英语作文提交与润色 | 7 | P0 | 光明4, 黑暗1, 灰色2 |
| CS-03 | 英语学习反思 | 4 | P1 | 光明2, 灰色2 |
| CS-04 | 英语作文管理 | 4 | P1 | 光明1, 黑暗1, 灰色2 |

---

## CS-01：学生入门

**描述**：新学生从注册到首次提交英语作文的完整旅程
**用户类型**：新注册的中国高中生
**核心价值**：快速进入系统，开始使用英语写作润色功能

**用户旅程**：
```
注册 → 登录 → 完善英语学习信息 → 进入英语写作界面
```

---

### MS-L-01：学生注册

**复杂故事**：CS-01
**故事类型**：光明（从无账户到有账户）
**优先级**：P0
**故事点数**：3

#### 用户故事
作为一个**想要提高英语写作水平的中国高中生**，
我想要**使用学号和邮箱注册账户**，
以便**开始使用英语写作润色功能**。

#### 故事评判
- **起点状态**：无法使用系统，被拦截在登录页
- **转折点**：完成注册流程
- **终点状态**：拥有学生账户，可以登录使用
- **情感体验**：从被拒绝 → 被接纳

#### 验收标准
- [ ] 学生可以看到注册入口
- [ ] 输入学号（格式：G202501001）、邮箱和密码后点击注册
- [ ] 系统验证学号格式（G开头+年级+序号）和邮箱有效性
- [ ] 注册成功后自动登录并跳转英语学习信息页
- [ ] 注册失败显示明确错误信息

#### 约束（来自 real.md）
- 无直接约束

#### 依赖
- **需要**：无
- **使能**：MS-L-02（登录）

---

### MS-L-02：学生登录

**复杂故事**：CS-01
**故事类型**：光明（从门外到进入）
**优先级**：P0
**故事点数**：2

#### 用户故事
作为一个**已注册的中国高中生**，
我想要**使用学号和密码登录**，
以便**访问我的英语作文和润色记录**。

#### 验收标准
- [ ] 学生可以看到登录表单
- [ ] 输入正确凭证后成功登录
- [ ] 登录后跳转到英语学习主页
- [ ] 登录状态持久化（刷新不丢失）

#### 依赖
- **需要**：MS-L-01（有账户）
- **使能**：MS-L-03（完善英语学习信息）

---

### MS-L-03：完善英语学习信息

**复杂故事**：CS-01
**故事类型**：光明（从匿名到个性化）
**优先级**：P0
**故事点数**：2

#### 用户故事
作为一个**首次登录的中国高中生**，
我想要**完善年级和英语水平信息**，
以便**获得更适合我的英语润色建议**。

#### 故事评判
- **起点状态**：只有基础账户信息
- **转折点**：完成英语学习信息填写
- **终点状态**：拥有完整英语学习档案
- **情感体验**：从普通 → 个性化

#### 验收标准
- [ ] 首次登录提示完善英语学习信息
- [ ] 可以选择年级（高一/高二/高三）
- [ ] 可以评估自己的英语水平（A1/初级, A2/基础, B1/中级, B2/中高级）
- [ ] 可以选择目标考试（高考/其他）
- [ ] 信息保存后进入英语写作主界面

#### 依赖
- **需要**：MS-L-02（登录）
- **使能**：MS-L-04（选择英语写作任务类型）

---

### MS-D-01：登录失败处理

**复杂故事**：CS-01
**故事类型**：黑暗（遇到障碍并恢复）
**优先级**：P0
**故事点数**：2

#### 用户故事
作为一个**输入错误凭证的学生**，
我想要**看到清晰的错误提示**，
以便**知道如何修正并重试**。

#### 验收标准
- [ ] 学号或密码错误时显示明确提示
- [ ] 提供"忘记密码"链接
- [ ] 连续失败后显示验证码
- [ ] 不泄露账户是否存在

#### 依赖
- **需要**：MS-L-02（登录流程）
- **使能**：无

---

## CS-02：英语作文提交与润色

**描述**：学生提交英语作文并使用AI进行润色的核心流程，支持应用文和读后续写两种高考题型
**用户类型**：已登录的中国高中生
**核心价值**：获得专业的英语写作润色建议，提高高考英语写作分数

**用户旅程**：
```
选择写作任务类型 → 新建英语作文 → 输入英语内容 → 选择英语润色方式 → 查看润色结果 → 保存版本
```

---

### MS-L-04：选择英语写作任务类型

**复杂故事**：CS-02
**故事类型**：光明（从模糊到明确）
**优先级**：P0
**故事点数**：2

#### 用户故事
作为一个**想要练习英语写作的中国高中生**，
我想要**选择具体的英语写作任务类型**，
以便**针对性地练习高考英语写作题型**。

#### 验收标准
- [ ] 点击"新建英语作文"按钮
- [ ] 显示两种主要任务类型：应用文（Practical Writing）和读后续写（Story Continuation）
- [ ] 每种类型显示说明和示例
- [ ] 选择后进入对应的作文创建界面

#### API
- GET /api/english-writing-tasks

#### 依赖
- **需要**：MS-L-03（完善英语学习信息）
- **使能**：MS-L-05（新建应用文）或 MS-L-05A（新建读后续写）

---

### MS-L-05：新建应用文

**复杂故事**：CS-02
**故事类型**：光明（从无到有）
**优先级**：P0
**故事点数**：2

#### 用户故事
作为一个**想要练习英语应用文写作的学生**，
我想要**创建一篇新的英语应用文**，
以便**开始英语应用文写作和润色**。

#### 验收标准
- [ ] 选择应用文子类型（书信、邮件、通知、演讲稿、申请信）
- [ ] 显示该子类型的格式要求和示例
- [ ] 输入作文标题（英文）
- [ ] 显示任务要求列表（如：自我介绍、询问信息、发出邀请等）
- [ ] 进入应用文编辑界面

#### API
- POST /api/english-essays/practical-writing

#### 依赖
- **需要**：MS-L-04（选择写作任务类型）
- **使能**：MS-L-06（输入英语内容）

---

### MS-L-05A：新建读后续写

**复杂故事**：CS-02
**故事类型**：光明（从无到有）
**优先级**：P0
**故事点数**：2

#### 用户故事
作为一个**想要练习英语读后续写的学生**，
我想要**创建一篇新的英语读后续写**，
以便**开始英语故事续写和润色**。

#### 验收标准
- [ ] 显示原文阅读材料（英文故事开头）
- [ ] 显示续写要求（字数、情节要求等）
- [ ] 输入续写标题（英文）
- [ ] 进入读后续写编辑界面
- [ ] 原文和编辑区分开显示

#### API
- POST /api/english-essays/story-continuation

#### 依赖
- **需要**：MS-L-04（选择写作任务类型）
- **使能**：MS-L-06（输入英语内容）

---

### MS-L-06：输入英语内容

**复杂故事**：CS-02
**故事类型**：光明（从空白到有内容）
**优先级**：P0
**故事点数**：3

#### 用户故事
作为一个**在编辑英语作文的学生**，
我想要**输入英语作文正文内容**，
以便**进行后续的英语润色**。

#### 验收标准
- [ ] 英语作文编辑器可用（支持英文拼写检查）
- [ ] 实时显示英文字数统计
- [ ] 对于应用文：提示检查是否完成所有任务要求
- [ ] 对于读后续写：提示检查情节连贯性和人物一致性
- [ ] 可以保存英语草稿
- [ ] 保存后进入英语润色选择界面

#### API
- PUT /api/english-essays/{id}/content

#### 依赖
- **需要**：MS-L-05（有应用文）或 MS-L-05A（有读后续写）
- **使能**：MS-L-07（选择英语润色方式）

---

### MS-L-07：选择英语润色方式

**复杂故事**：CS-02
**故事类型**：光明（从手动到智能辅助）
**优先级**：P0
**故事点数**：3

#### 用户故事
作为一个**完成英语作文初稿的学生**，
我想要**选择适合的英语润色方式**，
以便**获得针对英语作为第二语言的改进建议**。

#### 故事评判
- **起点状态**：有英语作文初稿但不知如何改进
- **转折点**：选择英语润色方式并开始分析
- **终点状态**：获得专业的英语润色建议
- **情感体验**：从迷茫 → 期待 → 获得帮助

#### 验收标准
- [ ] 显示可用的英语润色方式（语法润色/词汇润色/连贯性润色/任务完成度润色）
- [ ] 每种润色方式显示针对英语学习的说明
- [ ] 可以单选或多选润色类型
- [ ] 显示剩余API调用次数
- [ ] 点击"开始英语润色"按钮
- [ ] 显示润色进度

#### API
- POST /api/english-essays/{id}/polish

#### 约束（来自 real.md）
- C1：学生单个英语作品修改调用API次数上限42次

#### 依赖
- **需要**：MS-L-06（有英语作文内容）
- **使能**：MS-L-08（查看英语润色结果）

---

### MS-L-08：查看英语润色结果

**复杂故事**：CS-02
**故事类型**：光明（从问题到解决方案）
**优先级**：P0
**故事点数**：4

#### 用户故事
作为一个**等待英语润色结果的中国高中生**，
我想要**清晰地看到英语润色建议**，
以便**理解如何改进我的英语作文**。

#### 验收标准
- [ ] 英语润色完成后显示结果页面
- [ ] 英文原稿和润色稿并排显示
- [ ] 修改处高亮标记，显示具体的英语错误类型
- [ ] 显示修改理由和建议（用中文解释英语错误）
- [ ] 可以逐条接受或拒绝修改
- [ ] 对于语法错误：显示正确的英语语法规则
- [ ] 对于词汇错误：提供更地道的英语表达

#### API
- GET /api/english-essays/{id}/polish-result

#### 依赖
- **需要**：MS-L-07（选择英语润色方式）
- **使能**：MS-G-01（保存英语版本）

---

### MS-D-02：英语API调用次数限制提示

**复杂故事**：CS-02
**故事类型**：黑暗（遇到限制并调整）
**优先级**：P1
**故事点数**：2

#### 用户故事
作为一个**英语API调用次数接近上限的学生**，
我想要**看到剩余次数提示**，
以便**合理安排英语润色请求**。

#### 验收标准
- [ ] 英语润色前显示剩余API调用次数
- [ ] 次数不足时显示警告（用中文提示）
- [ ] 达到上限时禁用英语润色按钮
- [ ] 显示重置时间或增加次数的方法
- [ ] 提示学生先自行检查，再使用宝贵的机会

#### 依赖
- **需要**：MS-L-07（选择英语润色方式）
- **使能**：无

---

### MS-G-01：保存英语润色版本

**复杂故事**：CS-02
**故事类型**：灰色（日常操作）
**优先级**：P0
**故事点数**：2

#### 用户故事
作为一个**满意英语润色结果的学生**，
我想要**保存当前的英语润色版本**，
以便**后续继续修改或提交**。

#### 验收标准
- [ ] 点击"保存英语版本"按钮
- [ ] 输入版本说明（可选，可用中文）
- [ ] 保存成功提示
- [ ] 英语版本显示在历史记录中
- [ ] 记录本次润色解决了哪些英语问题

#### API
- POST /api/english-essays/{id}/versions

#### 约束（来自 real.md）
- C2：学生完成的最终版本，收入英语作文数据库

#### 依赖
- **需要**：MS-L-08（查看英语润色结果）
- **使能**：MS-G-02（继续修改英语作文）

---

### MS-G-02：继续修改英语作文

**复杂故事**：CS-02
**故事类型**：灰色（日常重复操作）
**优先级**：P1
**故事点数**：2

#### 用户故事
作为一个**想要进一步改进英语作文的学生**，
我想要**基于英语润色建议继续修改**，
以便**不断提高英语写作质量**。

#### 验收标准
- [ ] 在英语润色结果页可以点击"继续修改"
- [ ] 返回英语编辑界面，保留润色建议
- [ ] 修改后可以再次进行英语润色
- [ ] 英语历史版本记录完整
- [ ] 显示每次修改的英语改进点

#### 依赖
- **需要**：MS-G-01（有保存的英语版本）
- **使能**：无

---

## CS-03：英语学习反思

**描述**：学生通过对比英语版本和查看反馈进行英语学习反思
**用户类型**：已登录的中国高中生
**核心价值**：理解英语改进过程，形成符合英语表达习惯的写作风格

**用户旅程**：
```
查看英语历史版本 → 对比英语修改 → 阅读英语反馈 → 记录英语学习反思
```

---

### MS-L-09：查看英语作文历史版本

**复杂故事**：CS-03
**故事类型**：光明（从单一看当前到全面了解过程）
**优先级**：P1
**故事点数**：3

#### 用户故事
作为一个**想要了解英语写作进步过程的学生**，
我想要**查看英语作文的所有历史版本**，
以便**看到自己的英语改进轨迹**。

#### 验收标准
- [ ] 英语作文详情页显示"英语历史版本"标签
- [ ] 按时间倒序列出英语版本列表
- [ ] 每个版本显示创建时间和说明（可用中文）
- [ ] 点击版本可以查看英语内容
- [ ] 显示每个版本的英语错误统计

#### API
- GET /api/english-essays/{id}/versions

#### 约束（来自 real.md）
- C3：历史版本记录仅管理员与学生可见

#### 依赖
- **需要**：MS-G-01（有保存的英语版本）
- **使能**：MS-L-10（英语版本对比）

---

### MS-L-10：英语版本对比

**复杂故事**：CS-03
**故事类型**：光明（从模糊感觉到清晰认知）
**优先级**：P1
**故事点数**：3

#### 用户故事
作为一个**想要具体了解英语改进之处的学生**，
我想要**对比两个不同版本的英语作文**，
以便**清楚地看到英语修改效果**。

#### 故事评判
- **起点状态**：知道有英语改进但不清楚具体改了哪里
- **转折点**：看到并排对比和英语修改标记
- **终点状态**：清晰理解每个英语修改的意义
- **情感体验**：从模糊 → 清晰 → 有收获

#### 验收标准
- [ ] 可以选择两个英语版本进行对比
- [ ] 并排显示两个英语版本内容
- [ ] 英语差异处高亮标记，标注错误类型
- [ ] 显示英语修改统计（修改了多少处，各类错误数量）
- [ ] 可以查看每处英语修改的说明（用中文解释）

#### 依赖
- **需要**：MS-L-09（有英语历史版本）
- **使能**：MS-G-03（记录英语学习反思）

---

### MS-G-03：记录英语学习反思

**复杂故事**：CS-03
**故事类型**：灰色（英语学习习惯养成）
**优先级**：P1
**故事点数**：2

#### 用户故事
作为一个**从英语润色中学到东西的学生**，
我想要**记录本次的英语学习收获和反思**，
以便**巩固英语学习成果**。

#### 验收标准
- [ ] 在英语作文页面可以点击"记录英语反思"
- [ ] 弹出英语反思记录表单（支持中文输入）
- [ ] 可以记录学到了什么英语知识、还有什么疑问
- [ ] 可以记录常见的英语错误类型
- [ ] 反思保存后可以随时查看

#### API
- POST /api/english-essays/{id}/reflections

#### 依赖
- **需要**：MS-L-10（英语版本对比）
- **使能**：无

---

### MS-G-04：查看英语进步报告

**复杂故事**：CS-03
**故事类型**：灰色（定期回顾）
**优先级**：P2
**故事点数**：3

#### 用户故事
作为一个**想要了解自己英语进步情况的学生**，
我想要**查看英语写作能力的进步报告**，
以便**了解英语学习效果和调整学习计划**。

#### 验收标准
- [ ] 个人主页显示"英语进步报告"入口
- [ ] 显示英语作文数量、润色次数统计
- [ ] 显示常见英语错误改进趋势（语法、词汇、连贯性）
- [ ] 提供简单的英语数据可视化
- [ ] 显示英语写作能力评估（基于高考评分标准）

#### API
- GET /api/students/{id}/english-progress-report

#### 依赖
- **需要**：MS-L-09（有英语历史版本）
- **使能**：无

---

## CS-04：英语作文管理

**描述**：学生管理自己的英语作文集合
**用户类型**：已登录的中国高中生
**核心价值**：有序组织英语作文，方便查找和回顾

**用户旅程**：
```
浏览英语作文列表 → 搜索英语作文 → 提交英语最终版 → 查看提交状态
```

---

### MS-G-05：浏览英语作文列表

**复杂故事**：CS-04
**故事类型**：灰色（日常浏览）
**优先级**：P0
**故事点数**：2

#### 用户故事
作为一个**有多篇英语作文的学生**，
我想要**在主页浏览我的英语作文列表**，
以便**快速找到想要查看或修改的英语作文**。

#### 验收标准
- [ ] 主页显示英语作文列表
- [ ] 按最后修改时间倒序排列
- [ ] 显示英语作文标题（英文）、类型（应用文/读后续写）、状态
- [ ] 点击进入英语作文详情页
- [ ] 可以按类型筛选英语作文

#### API
- GET /api/students/{id}/english-essays

#### 依赖
- **需要**：MS-L-05或MS-L-05A（有英语作文）
- **使能**：无

---

### MS-L-11：搜索英语作文

**复杂故事**：CS-04
**故事类型**：光明（从找不到到找到）
**优先级**：P1
**故事点数**：3

#### 用户故事
作为一个**想要找到特定英语作文的学生**，
我想要**通过英文标题或内容关键词搜索英语作文**，
以便**快速定位目标英语作文**。

#### 验收标准
- [ ] 英语作文列表上方显示搜索框
- [ ] 输入英文关键词后实时显示匹配结果
- [ ] 支持按英文标题、英文内容、类型多条件搜索
- [ ] 英文搜索结果高亮匹配文本
- [ ] 支持中英文混合搜索

#### API
- GET /api/students/{id}/english-essays?q=keyword

#### 依赖
- **需要**：MS-G-05（有英语作文列表）
- **使能**：无

---

### MS-L-12：提交英语作文最终版

**复杂故事**：CS-04
**故事类型**：光明（从练习到正式提交）
**优先级**：P1
**故事点数**：3

#### 用户故事
作为一个**完成英语作文润色的学生**，
我想要**提交英语作文的最终版本**，
以便**完成本次英语写作练习**。

#### 故事评判
- **起点状态**：有多个英语润色版本但不確定哪个是最终版
- **转折点**：确认并提交英语最终版本
- **终点状态**：英语作文标记为已完成，进入英语数据库
- **情感体验**：从犹豫 → 确定 → 完成感

#### 验收标准
- [ ] 在英语作文页面可以点击"提交英语最终版"
- [ ] 选择要提交的英语版本
- [ ] 确认提交后不可再修改英语内容
- [ ] 显示英语提交成功提示
- [ ] 英语作文状态变为"已提交"
- [ ] 记录本次英语写作的总结

#### API
- POST /api/english-essays/{id}/submit-final

#### 约束（来自 real.md）
- C2：学生完成的最终版本，收入英语作文数据库
- C4：英语作文数据库内容仅管理员可见

#### 依赖
- **需要**：MS-G-01（有保存的英语版本）
- **使能**：无

---

### MS-D-03：查看英语提交状态

**复杂故事**：CS-04
**故事类型**：黑暗（状态不明确到明确）
**优先级**：P1
**故事点数**：2

#### 用户故事
作为一个**已提交英语作文的学生**，
我想要**查看英语作文的提交状态**，
以便**知道是否成功入库英语数据库**。

#### 验收标准
- [ ] 已提交英语作文显示"已提交"状态
- [ ] 显示英语提交时间
- [ ] 如果英语入库失败显示错误信息
- [ ] 提供重新提交英语的选项（如果允许）
- [ ] 显示英语作文已进入教师查看队列

#### 依赖
- **需要**：MS-L-12（提交英语最终版）
- **使能**：无

---

## 故事地图

```
学生旅程：英语学习入门 → 英语写作润色 → 英语学习反思 → 英语作文管理

迭代1（MVP）:
├── CS-01: 学生入门
│   ├── MS-L-01: 学生注册（光明）
│   ├── MS-L-02: 学生登录（光明）
│   ├── MS-L-03: 完善英语学习信息（光明）
│   └── MS-D-01: 登录失败处理（黑暗）
├── CS-02: 英语作文提交与润色
│   ├── MS-L-04: 选择英语写作任务类型（光明）
│   ├── MS-L-05: 新建应用文（光明）
│   ├── MS-L-06: 输入英语内容（光明）
│   ├── MS-L-07: 选择英语润色方式（光明）
│   ├── MS-L-08: 查看英语润色结果（光明）
│   └── MS-G-01: 保存英语润色版本（灰色）
└── CS-04: 英语作文管理
    └── MS-G-05: 浏览英语作文列表（灰色）

迭代2:
├── CS-02: 英语作文提交与润色（续）
│   ├── MS-L-05A: 新建读后续写（光明）
│   ├── MS-D-02: 英语API调用次数限制提示（黑暗）
│   └── MS-G-02: 继续修改英语作文（灰色）
├── CS-03: 英语学习反思
│   ├── MS-L-09: 查看英语作文历史版本（光明）
│   ├── MS-L-10: 英语版本对比（光明）
│   └── MS-G-03: 记录英语学习反思（灰色）
└── CS-04: 英语作文管理（续）
    ├── MS-L-11: 搜索英语作文（光明）
    └── MS-L-12: 提交英语作文最终版（光明）

迭代3:
├── CS-03: 英语学习反思（续）
│   └── MS-G-04: 查看英语进步报告（灰色）
└── CS-04: 英语作文管理（续）
    └── MS-D-03: 查看英语提交状态（黑暗）
```

---

## 故事类型分布

| 迭代 | 光明 | 黑暗 | 灰色 | 总计 |
|------|------|------|------|------|
| 迭代1 | 8 (73%) | 1 (9%) | 2 (18%) | 11 |
| 迭代2 | 4 (44%) | 1 (11%) | 4 (44%) | 9 |
| 迭代3 | 0 (0%) | 1 (33%) | 2 (67%) | 3 |

**符合 MVP 阶段黄金比例**：早期光明故事为主，快速展示英语写作核心价值。

---

## 质量检查清单

- [x] 所有核心功能都有对应的最小故事
- [x] 每个最小故事遵循 INVEST 原则
- [x] 故事类型分布合理（光明为主）
- [x] 验收标准清晰可测试
- [x] 依赖关系已识别
- [x] 故事规模适当（1-3天完成）
- [x] 反映了 real.md 中的约束
- [x] 故事地图显示清晰的英语学习旅程
- [x] 每个故事都有明确的英语学习价值

---

**文档版本**：v1.0.0
**创建日期**：2025-12-07
**维护者**：英语写作导师项目组